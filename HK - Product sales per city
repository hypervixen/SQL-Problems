SELECT 
    cit.city_name, 
    pr.product_name, 
    ROUND(SUM(invt.line_total_price), 2) AS tot
FROM city AS cit
JOIN customer AS cus 
    ON cit.id = cus.city_id
JOIN invoice AS inv 
    ON cus.id = inv.customer_id
JOIN invoice_item AS invt 
    ON inv.id = invt.invoice_id
JOIN product AS pr 
    ON invt.product_id = pr.id
GROUP BY cit.city_name, pr.product_name
ORDER BY tot DESC, cit.city_name, pr.product_name;
